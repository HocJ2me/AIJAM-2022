define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/admin-user-controls-after/add-user-notes-button",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile"],(function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=s.default;e.default=t})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/after-reviewable-post-user/show-user-notes-on-flags",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text","@ember/object"],(function(e,s,t,o,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={shouldRender:function(e,s){return s.siteSettings.user_notes_enabled&&e.user},setupComponent:function(e,t){var o=r.default.create(e.user).get("custom_fields.user_notes_count")||0;t.setProperties({userNotesCount:o,emojiEnabled:t.siteSettings.enable_emoji,emojiUrl:(0,n.emojiUrlFor)("pencil"),userNotesTitle:s.default.t("user_notes.show",{count:o})})},actions:{showUserNotes:function(){var e=this,s=(0,o.getOwner)(this).lookup("service:store"),n=this.get("args.user");(0,t.showUserNotes)(s,n.id,(function(s){return e.set("userNotesCount",s)}))}}};e.default=i})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-card-post-names/show-user-notes-on-card",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text"],(function(e,s,t,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={shouldRender:function(e,s){var t=s.siteSettings,o=s.currentUser;return t.user_notes_enabled&&o&&o.staff},setupComponent:function(e,t){var o=e.user,r=o.user_notes_count||o.get("custom_fields.user_notes_count")||0;t.setProperties({userNotesCount:r,emojiEnabled:t.siteSettings.enable_emoji,emojiUrl:(0,n.emojiUrlFor)("pencil"),userNotesTitle:s.default.t("user_notes.show",{count:r})})},actions:{showUserNotes:function(){var e=this;this.parentView.parentView._close();var s=(0,o.getOwner)(this).lookup("service:store"),n=this.get("args.user");(0,t.showUserNotes)(s,n.id,(function(s){e.isDestroying||e.isDestroyed||e.set("userNotesCount",s)}))}}};e.default=r})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner"],(function(e,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={shouldRender:function(e,s){var t=s.siteSettings,o=s.currentUser;return t.user_notes_enabled&&o&&o.staff},setupComponent:function(e,s){var t=e.model;s.set("userNotesCount",t.user_notes_count||t.get("custom_fields.user_notes_count")||0)},actions:{showUserNotes:function(){var e=this,o=(0,t.getOwner)(this).lookup("service:store"),n=this.get("args.model");(0,s.showUserNotes)(o,n.id,(function(s){return e.set("userNotesCount",s)}))}}};e.default=o})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes",["exports","discourse/lib/show-modal"],(function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.showUserNotes=function(e,t,o,n){return n=n||{},e.find("user-note",{user_id:t}).then((function(e){var r=(0,s.default)("user-notes",{model:e,title:"user_notes.title",addModalBodyView:!0});return r.reset(),r.setProperties({userId:t,callback:o,postId:n.postId}),r}))}})),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button"]=Ember.HTMLBars.template({id:null,block:'[[[1,[28,[35,0],null,[["show","count"],[[28,[37,1],[[30,0],"showUserNotes"],null],[33,2]]]]],[1,"\\n"]],[],false,["show-user-notes","action","userNotesCount"]]',moduleName:"javascripts/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button",isStrictMode:!1}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags"]=Ember.HTMLBars.template({id:null,block:'[[[41,[33,1],[[[1,"  "],[11,3],[24,6,""],[16,"title",[36,2]],[4,[38,3],[[30,0],"showUserNotes"],null],[12],[1,"\\n"],[41,[33,4],[[[1,"      "],[10,"img"],[15,"src",[36,5]],[15,"title",[36,2]],[14,"alt","pencil"],[14,0,"emoji"],[12],[13],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[35,6],["sticky-note"],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]],null]],[],false,["if","userNotesCount","userNotesTitle","action","emojiEnabled","emojiUrl","d-icon"]]',moduleName:"javascripts/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags",isStrictMode:!1}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card"]=Ember.HTMLBars.template({id:null,block:'[[[41,[33,1],[[[1,"  "],[11,3],[24,6,""],[16,"title",[36,2]],[4,[38,3],[[30,0],"showUserNotes"],null],[12],[1,"\\n"],[41,[33,4],[[[1,"      "],[10,"img"],[15,"src",[36,5]],[15,"title",[36,2]],[14,"alt","pencil"],[14,0,"emoji"],[12],[13],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[35,6],["sticky-note"],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]],null]],[],false,["if","userNotesCount","userNotesTitle","action","emojiEnabled","emojiUrl","d-icon"]]',moduleName:"javascripts/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card",isStrictMode:!1}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile"]=Ember.HTMLBars.template({id:null,block:'[[[1,[28,[35,0],null,[["show","count"],[[28,[37,1],[[30,0],"showUserNotes"],null],[33,2]]]]],[1,"\\n"]],[],false,["show-user-notes","action","userNotesCount"]]',moduleName:"javascripts/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile",isStrictMode:!1}),define("discourse/plugins/discourse-user-notes/discourse/adapters/user-note",["exports","discourse/adapters/rest","discourse/lib/ajax"],(function(e,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s.default.extend({destroyRecord:function(e,s,o){var n=this.pathFor(e,s,o.id);return(0,t.ajax)("".concat(n,"?user_id=").concat(o.user_id),{method:"DELETE"})}});e.default=o})),define("discourse/plugins/discourse-user-notes/discourse/components/show-user-notes",["exports","@ember/component","@ember/object/computed"],(function(e,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s.default.extend({tagName:"",showCount:(0,t.gt)("count",0)});e.default=o})),define("discourse/plugins/discourse-user-notes/discourse/controllers/user-notes",["exports","I18n","discourse-common/utils/decorators","discourse/lib/ajax-error","@ember/controller","bootbox"],(function(e,s,t,o,n,r){"use strict";var i,u,a;function l(e,s,t,o,n){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=t.slice().reverse().reduce((function(t,o){return o(e,s,t)||t}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,s,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=n.default.extend((i=(0,t.on)("init"),u=(0,t.default)("newNote","saving"),l(a={newNote:null,saving:!1,user:null,reset:function(){this.setProperties({newNote:null,saving:!1,callback:null})},attachDisabled:function(e,s){return s||!e||0===e.length},_refreshCount:function(){this.callback&&this.callback(this.get("model.length"))},actions:{attachNote:function(){var e=this,s=this.store.createRecord("user-note"),t=parseInt(this.userId,10);this.set("saving",!0);var n={raw:this.newNote,user_id:t};this.postId&&(n.post_id=parseInt(this.postId,10)),s.save(n).then((function(){e.set("newNote",""),e.model.insertAt(0,s),e._refreshCount()})).catch(o.popupAjaxError).finally((function(){return e.set("saving",!1)}))},removeNote:function(e){var t=this;r.default.confirm(s.default.t("user_notes.delete_confirm"),s.default.t("no_value"),s.default.t("yes_value"),(function(s){s&&e.destroyRecord().then((function(){t.model.removeObject(e),t._refreshCount()})).catch(o.popupAjaxError)}))}}},"reset",[i],Object.getOwnPropertyDescriptor(a,"reset"),a),l(a,"attachDisabled",[u],Object.getOwnPropertyDescriptor(a,"attachDisabled"),a),a));e.default=c})),define("discourse/plugins/discourse-user-notes/discourse/initializers/enable-user-notes",["exports","discourse/lib/plugin-api","discourse-common/lib/icon-library","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/utils/decorators"],(function(e,s,t,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={name:"enable-user-notes",initialize:function(e){var r=e.lookup("site-settings:main"),i=e.lookup("current-user:main");if(r.user_notes_enabled&&i&&i.staff){var u=e.lookup("service:store");(0,s.withPluginApi)("0.8.15",(function(e){var s,i,a,l,c,d,f,m,p,b;function h(){var e=this;(0,o.showUserNotes)(u,this.attrs.user_id,(function(s){e.sendWidgetAction("refreshUserNotes",s)}),{postId:this.attrs.id})}e.attachWidgetAction("post","refreshUserNotes",(function(e){var s=this.model.user_custom_fields||{};s.user_notes_count=e,this.model.set("user_custom_fields",s)})),e.modifyClass("controller:user",(s=(0,n.on)("init"),i=(0,n.observes)("model"),c=a={pluginId:"discourse-user-notes",userNotesCount:null,_modelChanged:function(){this.set("userNotesCount",this.get("model.custom_fields.user_notes_count")||0)},actions:{showUserNotes:function(){var e=this;(0,o.showUserNotes)(u,this.model.id,(function(s){return e.set("userNotesCount",s)}))}}},d="_modelChanged",f=[s,i],l=(l=Object.getOwnPropertyDescriptor(a,"_modelChanged"))?l.value:void 0,m={enumerable:!0,configurable:!0,writable:!0,initializer:function(){return l}},p=a,b={},Object.keys(m).forEach((function(e){b[e]=m[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=f.slice().reverse().reduce((function(e,s){return s(c,d,e)||e}),b),p&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(p):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(c,d,b),b=null),a));var v=e.container.lookup("site:main").mobileView?"before":"after";e.decorateWidget("poster-name:".concat(v),(function(e){if(!e.widget.settings.hideNotes)return(e.attrs.userCustomFields||{}).user_notes_count>0?e.attach("user-notes-icon"):void 0})),e.decorateWidget("post-avatar:after",(function(e){if(e.widget.settings.showNotes)return(e.attrs.userCustomFields||{}).user_notes_count>0?e.attach("user-notes-icon"):void 0})),e.decorateWidget("post-admin-menu:after",(function(e){return e.h("ul",e.attach("post-admin-menu-button",{icon:"pencil-alt",label:"user_notes.attach",action:"showUserNotes",secondaryAction:"closeAdminMenu",className:"add-user-note"}))})),e.attachWidgetAction("post","showUserNotes",h),e.createWidget("user-notes-icon",{tagName:"span.user-notes-icon",click:h,html:function(){return r.enable_emoji?this.attach("emoji",{name:"pencil"}):(0,t.iconNode)("sticky-note")}})}))}}};e.default=r})),Ember.TEMPLATES["javascripts/components/show-user-notes"]=Ember.HTMLBars.template({id:null,block:'[[[11,3],[24,6,""],[24,0,"btn btn-default"],[4,[38,0],[[30,0],[33,1]],null],[12],[1,"\\n  "],[1,[28,[35,2],["pencil-alt"],null]],[1,"\\n"],[41,[33,4],[[[1,"    "],[1,[28,[35,5],["user_notes.show"],[["count"],[[33,6]]]]],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,5],["user_notes.title"],null]],[1,"\\n"]],[]]],[13],[1,"\\n"]],[],false,["action","show","d-icon","if","showCount","i18n","count"]]',moduleName:"javascripts/discourse/templates/components/show-user-notes",isStrictMode:!1}),Ember.TEMPLATES["javascripts/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table"]=Ember.HTMLBars.template({id:null,block:'[[[41,[33,1,["user_notes_enabled"]],[[[1,"  "],[1,[28,[35,2],null,[["dataSourceName","startDate","endDate"],["user_notes",[33,3],[33,4]]]]],[1,"\\n"]],[]],null]],[],false,["if","siteSettings","admin-report","lastWeek","endDate"]]',moduleName:"javascripts/discourse/templates/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table",isStrictMode:!1}),Ember.TEMPLATES["javascripts/modal/user-notes"]=Ember.HTMLBars.template({id:null,block:'[[[6,[39,0],null,[["class"],["user-notes-modal"]],[["default"],[[[[1,"  "],[1,[28,[35,1],null,[["value"],[[33,2]]]]],[1,"\\n  "],[1,[28,[35,3],null,[["action","label","class","disabled"],[[28,[37,4],[[30,0],"attachNote"],null],"user_notes.attach","btn-primary",[33,5]]]]],[1,"\\n\\n"],[42,[28,[37,7],[[28,[37,7],[[33,8]],null]],null],null,[[[1,"    "],[10,0],[14,0,"user-note"],[12],[1,"\\n      "],[10,0],[14,0,"posted-by"],[12],[1,"\\n"],[6,[39,9],null,[["user"],[[30,1,["created_by"]]]],[["default"],[[[[1,"          "],[1,[28,[35,10],[[30,1,["created_by"]]],[["imageSize"],["small"]]]],[1,"\\n"]],[]]]]],[1,"      "],[13],[1,"\\n      "],[10,0],[14,0,"note-contents"],[12],[1,"\\n        "],[10,0],[14,0,"note-info"],[12],[1,"\\n          "],[10,1],[14,0,"username"],[12],[1,[30,1,["created_by","username"]]],[13],[1,"\\n          "],[10,1],[14,0,"post-date"],[12],[1,[28,[35,11],[[30,1,["created_at"]]],null]],[13],[1,"\\n\\n"],[41,[30,1,["can_delete"]],[[[1,"            "],[10,1],[14,0,"controls"],[12],[1,"\\n              "],[1,[28,[35,3],null,[["action","icon","class","title"],[[28,[37,4],[[30,0],"removeNote",[30,1]],null],"far-trash-alt","btn-small btn-danger","user_notes.remove"]]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"cooked"],[12],[1,"\\n          "],[1,[28,[35,13],[[30,1,["raw"]]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,1,["post_id"]],[[[1,"          "],[10,3],[15,6,[30,1,["post_url"]]],[14,0,"btn btn-small"],[12],[1,"\\n            "],[1,[28,[35,14],["user_notes.show_post"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"clearfix"],[12],[13],[1,"\\n    "],[13],[1,"\\n"]],[1]],null]],[]]]]]],["n"],false,["d-modal-body","textarea","newNote","d-button","action","attachDisabled","each","-track-array","model","user-link","avatar","age-with-tooltip","if","cook-text","i18n"]]',moduleName:"javascripts/discourse/templates/modal/user-notes",isStrictMode:!1});
//# sourceMappingURL=discourse-user-notes-4b68565afae0616bca3d268d8b300d8eb11538de5d4802f8c2e830b391d52793.js.map